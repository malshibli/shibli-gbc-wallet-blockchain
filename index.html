<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SHIBLI GBC Wallet</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f5faff; color: #2b4f81; margin: 0; padding: 0; }
    header { background: #2b4f81; color: white; padding: 20px; text-align: center; font-size: 22px; }
    .section { max-width: 850px; margin: 25px auto; padding: 25px; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    h2 { margin-top: 0; color: #2b4f81; }
    ul, ol { text-align: left; padding-left: 25px; }
    .icon { color: #2b4f81; margin-right: 10px; }
    input, button { width: 90%; padding: 10px; margin: 8px 0; border-radius: 6px; border: 1px solid #ccc; font-size: 15px; }
    button { background: #2b4f81; color: white; border: none; cursor: pointer; transition: 0.3s; }
    button:hover { background: #1d3d66; }
    .container { max-width: 700px; margin: 30px auto; padding: 20px; background: #eef6ff; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.07); }
    .balance { font-size: 18px; margin-top: 10px; }
    .highlight { color: #1a7e4e; font-weight: bold; }
  </style>
</head>
<body>

<header>
  <i class="fas fa-globe"></i> SHIBLI GBC Wallet
</header>

<div class="section">
  <h2><i class="fas fa-leaf icon"></i> Welcome to SHIBLI GBC</h2>
  <p><strong>The First Noble Global Birthright Currency</strong><br>Initiated by Professor Murad Al Shibli.</p>
  <p><i class="fas fa-hand-holding-heart icon"></i> Dignity-based universal income<br>
     <i class="fas fa-globe icon"></i> Equal global entitlement<br>
     <i class="fas fa-users icon"></i> Empowerment for all humanity</p>
</div>

<div class="section">
  <h2><i class="fas fa-bullseye icon"></i> SHIBLI GBC Goals</h2>
  <ul>
    <li><i class="fas fa-balance-scale icon"></i> Equality Beyond Borders</li>
    <li><i class="fas fa-handshake icon"></i> Universal Financial Access</li>
    <li><i class="fas fa-leaf icon"></i> Sustainable Economic Participation</li>
  </ul>
</div>

<div class="section">
  <h2><i class="fas fa-gift icon"></i> Global Entitlement</h2>
  <p><strong>0.0125 GBC ≈ $10,131 USD</strong><br>Your birthright dignity-based income share.</p>
</div>

<div class="section">
  <h2><i class="fas fa-user-check icon"></i> Request Your GBC</h2>
  <form onsubmit="return validateRequestAmount();" enctype="multipart/form-data">
    <input type="text" id="fullName" placeholder="Full Name" required>
    <input type="text" id="nationalID" placeholder="National ID or Passport No." required>
    <input type="text" id="walletInput" placeholder="MetaMask Wallet Address (Requester)" required>
    <input type="number" id="requestedAmount" placeholder="Enter amount (Max: 0.0125)" step="0.0001" min="0.0001" max="0.0125" required oninput="enforceMaxValue(this)">
    <label>Upload ID Document:</label><br>
    <input type="file" id="uploadID" accept=".jpg,.jpeg,.png,.pdf" required><br>
    <label>Upload Face Photo:</label><br>
    <input type="file" id="uploadFace" accept="image/*" required><br>
    <button type="submit"><i class="fas fa-paper-plane"></i> Submit Request</button>
  </form>
  <p id="requestMessage" style="color: green;"></p>
</div>

<div class="section">
  <h2><i class="fas fa-route icon"></i> How to Setup MetaMask</h2>
  <ol>
    <li>Install MetaMask: <a href="https://metamask.io/download" target="_blank">metamask.io</a></li>
    <li>Create Wallet → Save secret recovery phrase</li>
    <li>Enable Sepolia Test Network in Settings → Advanced</li>
    <li>Import GBC Token:<br>
        Address: <code>0x8357E2760CBd9867399b448DD11ab3458CaEcf93</code><br>
        Symbol: <code>GBC</code><br>
        Decimals: <code>18</code>
    </li>
  </ol>
</div>

<div class="section">
  <h2><i class="fas fa-shield-alt icon"></i> Admin Panel</h2>
  <p><strong>Connected Wallet:</strong> <span id="walletAddress">Not Connected</span></p>
  <button onclick="connectWallet()"><i class="fas fa-link"></i> Connect MetaMask</button>
  <p class="balance">Wallet Balance: <span id="balance">0</span> GBC</p>

  <h3><i class="fas fa-paper-plane icon"></i> Send Approved GBC</h3>
  <input type="text" id="sendAddress" placeholder="Recipient Wallet Address">
  <input type="number" id="sendAmount" placeholder="Amount to Send (Max 0.0125)">
  <button onclick="sendGBC()"><i class="fas fa-check-circle"></i> Send Approved GBC</button>
  <p id="transactionStatus" style="margin-top: 10px;"></p>
</div>

<script>
  let provider, signer, walletAddress;
  const contractAddress = "0x8357E2760CBd9867399b448DD11ab3458CaEcf93";
  const contractABI = [ /* keep ABI here as-is - you already pasted full ABI above */ ];

  window.connectWallet = async function () {
    if (!window.ethereum) {
      alert("Please install MetaMask!");
      return;
    }
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    walletAddress = await signer.getAddress();
    document.getElementById("walletAddress").innerText = walletAddress;
    getBalance();
  };

  async function getBalance() {
    if (!signer) return;
    try {
      const contract = new ethers.Contract(contractAddress, contractABI, signer);
      const balance = await contract.balanceOf(walletAddress);
      const formatted = ethers.utils.formatUnits(balance, 18);
      document.getElementById("balance").innerText = formatted;
    } catch (err) {
      console.error("Error reading balance:", err);
      document.getElementById("balance").innerText = "Error";
    }
  }

  window.sendGBC = async function () {
    const recipient = document.getElementById("sendAddress").value;
    const amount = document.getElementById("sendAmount").value;
    if (!recipient || !amount) {
      alert("Enter recipient and amount");
      return;
    }
    const contract = new ethers.Contract(contractAddress, contractABI, signer);
    const tx = await contract.transfer(recipient, ethers.utils.parseUnits(amount, 18));
    document.getElementById("transactionStatus").innerText = "Transaction Pending...";
    await tx.wait();
    document.getElementById("transactionStatus").innerText = "Transaction Successful!";
    getBalance();
  };

  function validateRequestAmount() {
    const amount = parseFloat(document.getElementById("requestedAmount").value);
    const capLimit = 0.0125;
    if (amount > capLimit) {
      alert("Maximum allowed per request is 0.0125 GBC.");
      return false;
    }
    const fullName = document.getElementById("fullName").value;
    const nationalID = document.getElementById("nationalID").value;
    const walletInput = document.getElementById("walletInput").value;
    const idFile = document.getElementById("uploadID").files[0];
    const faceFile = document.getElementById("uploadFace").files[0];

    if (!fullName || !nationalID || !walletInput || !idFile || !faceFile) {
      alert("Please complete all fields.");
      return false;
    }

    document.getElementById("requestMessage").innerText = "Request submitted successfully (Demo Only). You’ll be contacted after admin verification.";
    return false;
  }

  function enforceMaxValue(input) {
    const max = 0.0125;
    if (parseFloat(input.value) > max) input.value = max;
  }
</script>

</body>
</html>
